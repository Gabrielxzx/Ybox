C51 COMPILER V9.00   MENU                                                                  05/17/2015 19:37:51 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MENU
OBJECT MODULE PLACED IN menu.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE menu\menu.c BROWSE DEBUG OBJECTEXTEND PRINT(.\menu.lst) OBJECT(menu.obj)

line level    source

   1          /* ‰∏ªËèúÂçïÈÄâÈ°π
   2           * Ê¥ãÂ≠ê
   3           * purocean@gmail.com
   4           * 2015Âπ¥5Êúà10Êó•22:00:19
   5           */
   6          
   7          #include <reg51.h>
   8          #include <string.h>
   9          #include "../inc/event/event.h"
  10          #include "../inc/lcd/nokia_5110.h"
  11          #include "menu.h"
  12          #include "menu_data.h"
  13          #include "../about/about.h"
  14          #include "../racing/racing.h"
  15          
  16          void menu_init(void){
  17   1          Menu_id = 100;
  18   1          LCD_clear();
  19   1          menu_switch();
  20   1      }
  21          
  22          void menu_switch(void){
  23   1          unsigned char x = 0;
  24   1          unsigned char y = 5;
  25   1          unsigned int index = Menu_id / 10  - 10;
  26   1          unsigned char len = strlen(menu_text[index]);
  27   1      
  28   1          if(len <= 14){ // Â±èÂπï‰∏ÄË°åÊúÄÂ§öÊòæÁ§∫ 14 ‰∏™Â≠óÁ¨¶
  29   2              x = (LCD_WIDTH - len * 6) / 2; // Â±Ö‰∏≠ÊòæÁ§∫
  30   2          }
  31   1      
  32   1          LCD_draw_pic(26, 1, 32, 32, menu_icon[index]);
  33   1          LCD_draw_string_ascil_6x8(0, y, "              "); // ÁªòÂà∂ 14 ‰∏™Á©∫Ê†ºÔºåÈò≤Ê≠¢‰∏äÊ¨°ÊñáÂ≠óÁöÑÊÆãÁï
             -ô
  34   1          LCD_draw_string_ascil_6x8(x, y, menu_text[index]);
  35   1      }
  36          
  37          void menu_switch_loop(unsigned char is_left){
  38   1          unsigned char max_index = 100 + MENU_COUNT * 10 - 10;
  39   1      
  40   1          if(is_left){
  41   2              Menu_id = (Menu_id <= 100) ? max_index : Menu_id - 10;
  42   2          }else{
  43   2              Menu_id = (Menu_id >= max_index) ? 100 : Menu_id + 10;
  44   2          }
  45   1      
  46   1          menu_switch();
  47   1      }
  48          
  49          void menu(void){
  50   1          static bit key_flag = 1;
  51   1      
  52   1          if(KEY_LEFT){
  53   2              if(key_flag){
  54   3                  key_flag = 0;
C51 COMPILER V9.00   MENU                                                                  05/17/2015 19:37:51 PAGE 2   

  55   3                  menu_switch_loop(1);
  56   3              }
  57   2          }else if(KEY_RIGHT){
  58   2              if(key_flag){
  59   3                  key_flag = 0;
  60   3                  menu_switch_loop(0);
  61   3              }
  62   2          }else if(KEY_START){
  63   2              if(key_flag){
  64   3                  key_flag = 0;
  65   3                  switch(Menu_id){
  66   4                      case 100:
  67   4                          racing_init();
  68   4                          return;
  69   4                          break;
  70   4                      case 110:
  71   4                          about_init();
  72   4                          return;
  73   4                          break;
  74   4                  }
  75   3              }
  76   2          }else if(KEY_EXIT){
  77   2              if(key_flag){
  78   3                  menu_init();
  79   3                  key_flag = 0;
  80   3                  return;
  81   3              }
  82   2          }else{
  83   2              key_flag = 1;
  84   2          }
  85   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    329    ----
   CONSTANT SIZE    =    290    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
