C51 COMPILER V9.00   MENU                                                                  05/21/2015 16:32:41 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MENU
OBJECT MODULE PLACED IN menu.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE menu\menu.c OPTIMIZE(9,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\menu.lst) O
                    -BJECT(menu.obj)

line level    source

   1          /* ‰∏ªËèúÂçïÈÄâÈ°π
   2           * Ê¥ãÂ≠ê
   3           * purocean@gmail.com
   4           * 2015Âπ¥5Êúà10Êó•22:00:19
   5           */
   6          
   7          #include <reg51.h>
   8          #include <string.h>
   9          #include "../inc/event/event.h"
  10          #include "../inc/lcd/nokia_5110.h"
  11          #include "menu.h"
  12          #include "menu_data.h"
  13          #include "../about/about.h"
  14          #include "../mine/mine.h"
  15          
  16          enum FID Func_id = MENU;
  17          unsigned char menu_id = MENU_COUNT - 1;
  18          
  19          void menu_init(void){
  20   1          Func_id = MENU;
  21   1          LCD_clear();
  22   1          menu_switch();
  23   1      }
  24          
  25          void menu_switch(void){
  26   1          unsigned char x;
  27   1          unsigned char len = strlen(menu_text[menu_id]);
  28   1      
  29   1          x = len <= 14 ? (LCD_WIDTH - len * 6) / 2 : 0; // Â±èÂπï‰∏ÄË°åÊúÄÂ§öÊòæÁ§∫ 14 ‰∏™Â≠óÁ¨¶, Â±Ö‰∏≠ÊòæÁ§∫
  30   1      
  31   1          LCD_draw_pic(26, 1, 32, 32, menu_icon[menu_id]);
  32   1          LCD_draw_string_ascil_6x8(0, 5, "              "); // ÁªòÂà∂ 14 ‰∏™Á©∫Ê†ºÔºåÈò≤Ê≠¢‰∏äÊ¨°ÊñáÂ≠óÁöÑÊÆãÁï
             -ô
  33   1          LCD_draw_string_ascil_6x8(x, 5, menu_text[menu_id]);
  34   1      }
  35          
  36          void menu(void){
  37   1          static bit key_flag = 1;
  38   1      
  39   1          if(KEY_LEFT){
  40   2              if(key_flag){
  41   3                  key_flag = 0;
  42   3      
  43   3                  menu_id = (menu_id <= 0) ? MENU_COUNT - 1 : menu_id - 1;
  44   3                  menu_switch();
  45   3              }
  46   2          }else if(KEY_RIGHT){
  47   2              if(key_flag){
  48   3                  key_flag = 0;
  49   3      
  50   3                  menu_id = (menu_id >= MENU_COUNT - 1) ?  0: menu_id + 1;
  51   3                  menu_switch();
  52   3              }
  53   2          }else if(KEY_START){
C51 COMPILER V9.00   MENU                                                                  05/21/2015 16:32:41 PAGE 2   

  54   2              if(key_flag){
  55   3                  key_flag = 0;
  56   3                  switch(menu_id){
  57   4                      case 1:
  58   4                          mine_init();
  59   4                          return;
  60   4                          break;
  61   4                      case 0:
  62   4                          about_init();
  63   4                          return;
  64   4                          break;
  65   4                  }
  66   3              }
  67   2          }else if(KEY_EXIT){
  68   2              key_flag = 0;
  69   2      
  70   2              menu_id = MENU_COUNT - 1;
  71   2              menu_switch();
  72   2          }else{
  73   2              key_flag = 1;
  74   2          }
  75   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    215    ----
   CONSTANT SIZE    =    288    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
