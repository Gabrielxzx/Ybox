C51 COMPILER V9.00   MENU                                                                  05/17/2015 19:11:55 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE MENU
OBJECT MODULE PLACED IN menu.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE menu\menu.c BROWSE DEBUG OBJECTEXTEND PRINT(.\menu.lst) OBJECT(menu.obj)

line level    source

   1          /* ‰∏ªËèúÂçïÈÄâÈ°π
   2           * Ê¥ãÂ≠ê
   3           * purocean@gmail.com
   4           * 2015Âπ¥5Êúà10Êó•22:00:19
   5           */
   6          
   7          #include <reg51.h>
   8          #include <string.h>
   9          #include "../inc/event/event.h"
  10          #include "../inc/lcd/nokia_5110.h"
  11          #include "menu.h"
  12          #include "menu_data.h"
  13          #include "../about/about.h"
  14          #include "../racing/racing.h"
  15          
  16          void menu_init(void){
  17   1          Menu_id = 100;
  18   1          LCD_clear();
  19   1      }
  20          
  21          void menu_switch(void){
  22   1          unsigned char x = 0;
  23   1          unsigned char y = 5;
  24   1          unsigned int index = Menu_id / 10  - 10;
  25   1          unsigned char len = strlen(menu_text[index]);
  26   1      
  27   1          if(len <= 14){ // Â±èÂπï‰∏ÄË°åÊúÄÂ§öÊòæÁ§∫ 14 ‰∏™Â≠óÁ¨¶
  28   2              x = (LCD_WIDTH - len * 6) / 2; // Â±Ö‰∏≠ÊòæÁ§∫
  29   2          }
  30   1      
  31   1          LCD_draw_pic(26, 1, 32, 32, menu_icon[index]);
  32   1          LCD_draw_string_ascil_6x8(0, y, "              "); // ÁªòÂà∂ 14 ‰∏™Á©∫Ê†ºÔºåÈò≤Ê≠¢‰∏äÊ¨°ÊñáÂ≠óÁöÑÊÆãÁï
             -ô
  33   1          LCD_draw_string_ascil_6x8(x, y, menu_text[index]);
  34   1      }
  35          
  36          void menu_switch_loop(unsigned char is_left){
  37   1          unsigned char max_index = 100 + MENU_COUNT * 10 - 10;
  38   1      
  39   1          if(is_left){
  40   2              Menu_id = (Menu_id <= 100) ? max_index : Menu_id - 10;
  41   2          }else{
  42   2              Menu_id = (Menu_id >= max_index) ? 100 : Menu_id + 10;
  43   2          }
  44   1      }
  45          
  46          void menu(void){
  47   1          static bit key_flag = 1;
  48   1      
  49   1          if(KEY_LEFT){
  50   2              if(key_flag){
  51   3                  key_flag = 0;
  52   3                  menu_switch_loop(1);
  53   3              }
  54   2          }else if(KEY_RIGHT){
C51 COMPILER V9.00   MENU                                                                  05/17/2015 19:11:55 PAGE 2   

  55   2              if(key_flag){
  56   3                  key_flag = 0;
  57   3                  menu_switch_loop(0);
  58   3              }
  59   2          }else if(KEY_START){
  60   2              if(key_flag){
  61   3                  key_flag = 0;
  62   3                  switch(Menu_id){
  63   4                      case 100:
  64   4                          racing_init();
  65   4                          return;
  66   4                          break;
  67   4                      case 110:
  68   4                          about_init();
  69   4                          return;
  70   4                          break;
  71   4                  }
  72   3              }
  73   2          }else if(KEY_EXIT){
  74   2              if(key_flag){
  75   3                  menu_init();
  76   3                  key_flag = 0;
  77   3                  return;
  78   3              }
  79   2          }else{
  80   2              key_flag = 1;
  81   2          }
  82   1      
  83   1          menu_switch();
  84   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    328    ----
   CONSTANT SIZE    =    290    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
